<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Scanner</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.umd.js"></script>
    <style>
        .loader {
            border-top-color: #3498db;
            animation: spinner 1.5s linear infinite;
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .port-open {
            background-color: rgba(52, 211, 153, 0.1);
            border-left: 4px solid rgb(52, 211, 153);
        }
        .vuln-high {
            background-color: rgba(239, 68, 68, 0.1);
            border-left: 4px solid rgb(239, 68, 68);
        }
        .vuln-medium {
            background-color: rgba(245, 158, 11, 0.1);
            border-left: 4px solid rgb(245, 158, 11);
        }
        .vuln-low {
            background-color: rgba(59, 130, 246, 0.1);
            border-left: 4px solid rgb(59, 130, 246);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <header class="flex items-center justify-between mb-8">
            <div class="flex items-center space-x-3">
                <div class="bg-blue-600 text-white p-2 rounded-lg">
                    <i data-lucide="scan" class="w-6 h-6"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-800">Network Scanner</h1>
            </div>
            <div class="flex items-center space-x-2 text-sm text-gray-600">
                <i data-lucide="shield" class="w-4 h-4"></i>
                <span>Educational Use Only</span>
            </div>
        </header>

        <!-- Main Content -->
        <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Left Panel - Scan Controls -->
            <div class="lg:col-span-1 bg-white rounded-xl shadow-md p-6">
                <div class="flex items-center space-x-2 mb-4">
                    <i data-lucide="target" class="w-5 h-5 text-blue-600"></i>
                    <h2 class="font-semibold text-gray-700">Scan Configuration</h2>
                </div>
                
                <form id="scanForm" class="space-y-4">
                    <div>
                        <label for="ip_range" class="block text-sm font-medium text-gray-700 mb-1">IP Range</label>
                        <div class="flex items-center border border-gray-300 rounded-lg overflow-hidden focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500">
                            <div class="px-3 py-2 bg-gray-50 border-r border-gray-300">
                                <i data-lucide="network" class="w-5 h-5 text-gray-500"></i>
                            </div>
                            <input 
                                type="text" 
                                id="ip_range" 
                                name="ip_range" 
                                class="flex-1 p-2 outline-none text-gray-700" 
                                placeholder="192.168.1.0/24 or 192.168.1.1-192.168.1.10"
                            >
                        </div>
                        <p class="mt-1 text-xs text-gray-500">CIDR notation or IP range (max 256 IPs)</p>
                    </div>

                    <div class="pt-2">
                        <button 
                            type="submit" 
                            id="scanButton"
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center space-x-2 transition"
                        >
                            <i data-lucide="search" class="w-5 h-5"></i>
                            <span>Start Scan</span>
                        </button>
                    </div>
                </form>

                <!-- Quick Reference -->
                <div class="mt-8">
                    <div class="flex items-center space-x-2 mb-3">
                        <i data-lucide="file-text" class="w-5 h-5 text-blue-600"></i>
                        <h3 class="font-semibold text-gray-700">Quick Reference</h3>
                    </div>
                    <div class="text-sm text-gray-600 space-y-2">
                        <div class="flex items-start space-x-2">
                            <i data-lucide="info" class="w-4 h-4 text-blue-500 mt-0.5"></i>
                            <p>Open ports are potential entry points for attackers. The fewer open ports, the smaller your attack surface.</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <i data-lucide="shield-alert" class="w-4 h-4 text-orange-500 mt-0.5"></i>
                            <p>Common vulnerable services: FTP (21), Telnet (23), SMB (445), RDP (3389)</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <i data-lucide="lock" class="w-4 h-4 text-green-500 mt-0.5"></i>
                            <p>Always protect network services with strong authentication and encryption</p>
                        </div>
                        <div class="flex items-start space-x-2">
                            <i data-lucide="alert-circle" class="w-4 h-4 text-red-500 mt-0.5"></i>
                            <p> Scan scans show Shodan data for public IPs when used remotely. Run locally to scan your private network.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Results -->
            <div class="lg:col-span-2 bg-white rounded-xl shadow-md p-6">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center space-x-2">
                        <i data-lucide="list" class="w-5 h-5 text-blue-600"></i>
                        <h2 class="font-semibold text-gray-700">Scan Results</h2>
                    </div>
                    <div id="scanStatus" class="text-sm font-medium text-gray-500">Ready to scan</div>
                </div>

                <div id="loader" class="hidden">
                    <div class="flex flex-col items-center justify-center py-12">
                        <div class="loader h-12 w-12 border-4 border-gray-200 rounded-full"></div>
                        <p class="mt-4 text-gray-600">Scanning network...</p>
                    </div>
                </div>

                <div id="noResults" class="hidden">
                    <div class="flex flex-col items-center justify-center py-12 text-gray-500">
                        <i data-lucide="search-x" class="w-12 h-12 mb-4"></i>
                        <p>No scan results yet. Enter an IP range and start scanning.</p>
                    </div>
                </div>

                <div id="resultsContainer" class="hidden">
                    <div class="mb-4 flex items-center justify-between">
                        <div class="flex space-x-4">
                            <div class="text-sm font-medium">
                                <span class="text-gray-500">Scanned: </span>
                                <span id="scannedCount" class="text-gray-900">0</span>
                            </div>
                            <div class="text-sm font-medium">
                                <span class="text-gray-500">Open Ports: </span>
                                <span id="openPortsCount" class="text-gray-900">0</span>
                            </div>
                            <div class="text-sm font-medium">
                                <span class="text-gray-500">Vulnerabilities: </span>
                                <span id="vulnCount" class="text-gray-900">0</span>
                            </div>
                        </div>
                        <button id="clearResults" class="text-sm text-gray-500 hover:text-gray-700 flex items-center space-x-1">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                            <span>Clear</span>
                        </button>
                    </div>

                    <div id="resultsAccordion" class="space-y-3">
                        <!-- Results will be populated here by JavaScript -->
                    </div>
                </div>
            </div>
        </main>

        <!-- Educational Section -->
        <section class="mt-8 bg-white rounded-xl shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center space-x-2">
                    <i data-lucide="graduation-cap" class="w-5 h-5 text-blue-600"></i>
                    <h2 class="font-semibold text-gray-700">Understanding Network Reconnaissance</h2>
                </div>
                
                <!-- Tab Navigation -->
                <div class="flex space-x-2 text-sm">
                    <button id="basicInfoTab" class="px-3 py-1 bg-blue-100 text-blue-800 rounded-lg font-medium">Basic Info</button>
                    <button id="commonPortsTab" class="px-3 py-1 text-gray-600 hover:bg-gray-100 rounded-lg font-medium">Common Ports</button>
                </div>
            </div>

            <!-- Basic Info Tab Content -->
            <div id="basicInfoContent" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="flex items-center space-x-2 mb-3">
                        <div class="bg-blue-100 p-2 rounded-lg">
                            <i data-lucide="scan" class="w-5 h-5 text-blue-600"></i>
                        </div>
                        <h3 class="font-medium text-gray-700">What is Port Scanning?</h3>
                    </div>
                    <p class="text-sm text-gray-600">Port scanning is a technique used to identify open ports and services on a network. Each open port potentially represents a service that could be exploited if not properly secured.</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="flex items-center space-x-2 mb-3">
                        <div class="bg-orange-100 p-2 rounded-lg">
                            <i data-lucide="shield-off" class="w-5 h-5 text-orange-600"></i>
                        </div>
                        <h3 class="font-medium text-gray-700">Attack Vectors</h3>
                    </div>
                    <p class="text-sm text-gray-600">Attackers use reconnaissance to discover vulnerabilities. They look for outdated services, default configurations, and known exploits to gain unauthorized access to systems.</p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                    <div class="flex items-center space-x-2 mb-3">
                        <div class="bg-green-100 p-2 rounded-lg">
                            <i data-lucide="shield" class="w-5 h-5 text-green-600"></i>
                        </div>
                        <h3 class="font-medium text-gray-700">Defense Strategies</h3>
                    </div>
                    <p class="text-sm text-gray-600">Practice the principle of least privilege by only running necessary services. Use firewalls, keep systems updated, and implement strong authentication to minimize your attack surface.</p>
                </div>
            </div>

            <!-- Common Ports Tab Content -->
            <div id="commonPortsContent" class="hidden">
                <div class="mb-4 flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <i data-lucide="list" class="w-5 h-5 text-blue-600"></i>
                        <h3 class="font-medium text-gray-700">100 Common Ports & Their Vulnerabilities</h3>
                    </div>
                    <div class="relative">
                        <input 
                            type="text" 
                            id="portSearch" 
                            placeholder="Search ports..." 
                            class="pl-8 pr-3 py-1 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                        >
                        <i data-lucide="search" class="w-4 h-4 text-gray-400 absolute left-2 top-1/2 transform -translate-y-1/2"></i>
                    </div>
                </div>
                
                <div class="overflow-hidden border border-gray-200 rounded-lg">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Port</th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Service</th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Potential Vulnerabilities</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200 text-sm" id="portsTableBody">
                            <tr>
                                <td class="px-4 py-3 font-medium">20/21</td>
                                <td class="px-4 py-3">FTP</td>
                                <td class="px-4 py-3">File Transfer Protocol</td>
                                <td class="px-4 py-3 text-red-600">Anonymous access, cleartext credentials, outdated versions (ProFTPD, vsftpd), directory traversal</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">22</td>
                                <td class="px-4 py-3">SSH</td>
                                <td class="px-4 py-3">Secure Shell</td>
                                <td class="px-4 py-3 text-red-600">Weak passwords, outdated versions (OpenSSH < 7.9), brute force attacks, SSH key mismanagement</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">23</td>
                                <td class="px-4 py-3">Telnet</td>
                                <td class="px-4 py-3">Telnet</td>
                                <td class="px-4 py-3 text-red-600">Cleartext communications, no encryption, susceptible to MITM attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">25</td>
                                <td class="px-4 py-3">SMTP</td>
                                <td class="px-4 py-3">Simple Mail Transfer Protocol</td>
                                <td class="px-4 py-3 text-red-600">Open relay, email spoofing, outdated servers (Exim, Sendmail), SMTP injection</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">53</td>
                                <td class="px-4 py-3">DNS</td>
                                <td class="px-4 py-3">Domain Name System</td>
                                <td class="px-4 py-3 text-red-600">DNS cache poisoning, zone transfers, DDoS amplification, outdated BIND servers</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">67/68</td>
                                <td class="px-4 py-3">DHCP</td>
                                <td class="px-4 py-3">Dynamic Host Configuration Protocol</td>
                                <td class="px-4 py-3 text-red-600">DHCP starvation, rogue DHCP servers, IP spoofing</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">69</td>
                                <td class="px-4 py-3">TFTP</td>
                                <td class="px-4 py-3">Trivial File Transfer Protocol</td>
                                <td class="px-4 py-3 text-red-600">No authentication, cleartext transfers, directory traversal</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">80</td>
                                <td class="px-4 py-3">HTTP</td>
                                <td class="px-4 py-3">Hypertext Transfer Protocol</td>
                                <td class="px-4 py-3 text-red-600">SQL injection, XSS, CSRF, directory traversal, file inclusion, outdated web servers (Apache, Nginx)</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">88</td>
                                <td class="px-4 py-3">Kerberos</td>
                                <td class="px-4 py-3">Authentication protocol</td>
                                <td class="px-4 py-3 text-red-600">Pass-the-ticket, Kerberoasting, Golden Ticket, authentication bypass</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">110</td>
                                <td class="px-4 py-3">POP3</td>
                                <td class="px-4 py-3">Post Office Protocol v3</td>
                                <td class="px-4 py-3 text-red-600">Cleartext authentication, brute force attacks, outdated mail servers</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">111</td>
                                <td class="px-4 py-3">RPCBind</td>
                                <td class="px-4 py-3">Remote Procedure Call</td>
                                <td class="px-4 py-3 text-red-600">Service enumeration, buffer overflows, DoS conditions</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">123</td>
                                <td class="px-4 py-3">NTP</td>
                                <td class="px-4 py-3">Network Time Protocol</td>
                                <td class="px-4 py-3 text-red-600">NTP reflection attacks, DDoS amplification, time spoofing</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">135</td>
                                <td class="px-4 py-3">MSRPC</td>
                                <td class="px-4 py-3">Microsoft RPC</td>
                                <td class="px-4 py-3 text-red-600">Remote code execution, service enumeration, EternalBlue</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">137-139</td>
                                <td class="px-4 py-3">NetBIOS</td>
                                <td class="px-4 py-3">NetBIOS</td>
                                <td class="px-4 py-3 text-red-600">Name service spoofing, null sessions, system information enumeration</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">143</td>
                                <td class="px-4 py-3">IMAP</td>
                                <td class="px-4 py-3">Internet Message Access Protocol</td>
                                <td class="px-4 py-3 text-red-600">Cleartext authentication, brute force attacks, outdated mail servers</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">161/162</td>
                                <td class="px-4 py-3">SNMP</td>
                                <td class="px-4 py-3">Simple Network Management Protocol</td>
                                <td class="px-4 py-3 text-red-600">Default community strings, information disclosure, SNMPv1/v2 no encryption</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">389</td>
                                <td class="px-4 py-3">LDAP</td>
                                <td class="px-4 py-3">Lightweight Directory Access Protocol</td>
                                <td class="px-4 py-3 text-red-600">Cleartext authentication, information disclosure, injection attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">443</td>
                                <td class="px-4 py-3">HTTPS</td>
                                <td class="px-4 py-3">HTTP Secure</td>
                                <td class="px-4 py-3 text-red-600">SSL/TLS vulnerabilities (Heartbleed, POODLE), weak ciphers, certificate issues</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">445</td>
                                <td class="px-4 py-3">SMB</td>
                                <td class="px-4 py-3">Server Message Block</td>
                                <td class="px-4 py-3 text-red-600">EternalBlue, SMBGhost, null sessions, relay attacks, outdated Samba</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">464</td>
                                <td class="px-4 py-3">Kerberos</td>
                                <td class="px-4 py-3">Kerberos password change</td>
                                <td class="px-4 py-3 text-red-600">Password policy bypass, brute force attacks, AS-REP roasting</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">500</td>
                                <td class="px-4 py-3">IKE</td>
                                <td class="px-4 py-3">Internet Key Exchange (VPN)</td>
                                <td class="px-4 py-3 text-red-600">Aggressive mode weaknesses, pre-shared key disclosure, crypto flaws</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">514</td>
                                <td class="px-4 py-3">RSH</td>
                                <td class="px-4 py-3">Remote Shell</td>
                                <td class="px-4 py-3 text-red-600">Host authentication bypass, no encryption, command injection</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">515</td>
                                <td class="px-4 py-3">LPD</td>
                                <td class="px-4 py-3">Line Printer Daemon</td>
                                <td class="px-4 py-3 text-red-600">Buffer overflows, unauthorized access, DoS attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">520</td>
                                <td class="px-4 py-3">RIP</td>
                                <td class="px-4 py-3">Routing Information Protocol</td>
                                <td class="px-4 py-3 text-red-600">Route poisoning, rogue routing updates, traffic hijacking</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">587</td>
                                <td class="px-4 py-3">SMTP (Submission)</td>
                                <td class="px-4 py-3">Mail Submission</td>
                                <td class="px-4 py-3 text-red-600">Similar to port 25 - authentication bypass, mail spoofing</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">636</td>
                                <td class="px-4 py-3">LDAPS</td>
                                <td class="px-4 py-3">LDAP over SSL</td>
                                <td class="px-4 py-3 text-red-600">Certificate validation issues, weak ciphers, LDAP injection</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">873</td>
                                <td class="px-4 py-3">Rsync</td>
                                <td class="px-4 py-3">Remote Sync</td>
                                <td class="px-4 py-3 text-red-600">Anonymous access, insecure permissions, data exfiltration</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">995</td>
                                <td class="px-4 py-3">POP3S</td>
                                <td class="px-4 py-3">POP3 over SSL</td>
                                <td class="px-4 py-3 text-red-600">SSL/TLS vulnerabilities, weak authentication, outdated mail servers</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">993</td>
                                <td class="px-4 py-3">IMAPS</td>
                                <td class="px-4 py-3">IMAP over SSL</td>
                                <td class="px-4 py-3 text-red-600">SSL/TLS vulnerabilities, weak authentication, outdated mail servers</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">1080</td>
                                <td class="px-4 py-3">SOCKS Proxy</td>
                                <td class="px-4 py-3">SOCKS Proxy</td>
                                <td class="px-4 py-3 text-red-600">Open proxy, anonymous traffic routing, authentication bypass</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">1433</td>
                                <td class="px-4 py-3">MSSQL</td>
                                <td class="px-4 py-3">Microsoft SQL Server</td>
                                <td class="px-4 py-3 text-red-600">Weak SA password, SQL injection, stored procedures abuse</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">1434</td>
                                <td class="px-4 py-3">MSSQL Browser</td>
                                <td class="px-4 py-3">SQL Server Browser</td>
                                <td class="px-4 py-3 text-red-600">SQL instance enumeration, information disclosure, DoS attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">1521</td>
                                <td class="px-4 py-3">Oracle DB</td>
                                <td class="px-4 py-3">Oracle Database</td>
                                <td class="px-4 py-3 text-red-600">Default credentials, TNS poisoning, PL/SQL injection</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">1723</td>
                                <td class="px-4 py-3">PPTP</td>
                                <td class="px-4 py-3">Point-to-Point Tunneling Protocol</td>
                                <td class="px-4 py-3 text-red-600">Weak encryption (MS-CHAPv2), authentication bypass</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">1883</td>
                                <td class="px-4 py-3">MQTT</td>
                                <td class="px-4 py-3">Message Queuing Telemetry Transport</td>
                                <td class="px-4 py-3 text-red-600">No encryption by default, weak authentication, IoT device takeover</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">2049</td>
                                <td class="px-4 py-3">NFS</td>
                                <td class="px-4 py-3">Network File System</td>
                                <td class="px-4 py-3 text-red-600">Insecure exports, no authentication, sensitive file access</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">2375/2376</td>
                                <td class="px-4 py-3">Docker</td>
                                <td class="px-4 py-3">Docker API</td>
                                <td class="px-4 py-3 text-red-600">Unauthorized container access, host system compromise (2375 is unencrypted)</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">3128</td>
                                <td class="px-4 py-3">Squid Proxy</td>
                                <td class="px-4 py-3">Web Proxy</td>
                                <td class="px-4 py-3 text-red-600">Misconfigured proxy, unauthorized access, information disclosure</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">3306</td>
                                <td class="px-4 py-3">MySQL</td>
                                <td class="px-4 py-3">MySQL Database</td>
                                <td class="px-4 py-3 text-red-600">Default credentials, SQL injection, outdated versions</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">3389</td>
                                <td class="px-4 py-3">RDP</td>
                                <td class="px-4 py-3">Remote Desktop Protocol</td>
                                <td class="px-4 py-3 text-red-600">BlueKeep (CVE-2019-0708), brute force attacks, MitM attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">3690</td>
                                <td class="px-4 py-3">SVN</td>
                                <td class="px-4 py-3">Subversion</td>
                                <td class="px-4 py-3 text-red-600">Repository access, source code disclosure, weak authentication</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">4333</td>
                                <td class="px-4 py-3">mSQL</td>
                                <td class="px-4 py-3">Mini SQL</td>
                                <td class="px-4 py-3 text-red-600">Default credentials, SQL injection, outdated versions</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5000</td>
                                <td class="px-4 py-3">Flask/Synology</td>
                                <td class="px-4 py-3">Web Framework/NAS</td>
                                <td class="px-4 py-3 text-red-600">Debug mode enabled, information disclosure, authentication bypass</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5040</td>
                                <td class="px-4 py-3">DCE/RPC</td>
                                <td class="px-4 py-3">DCE/RPC Endpoint Mapper</td>
                                <td class="px-4 py-3 text-red-600">Service enumeration, remote code execution</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5060/5061</td>
                                <td class="px-4 py-3">SIP</td>
                                <td class="px-4 py-3">Session Initiation Protocol</td>
                                <td class="px-4 py-3 text-red-600">VoIP eavesdropping, call hijacking, toll fraud (5060 unencrypted, 5061 TLS)</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5432</td>
                                <td class="px-4 py-3">PostgreSQL</td>
                                <td class="px-4 py-3">PostgreSQL Database</td>
                                <td class="px-4 py-3 text-red-600">Default credentials, SQL injection, outdated versions</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5632</td>
                                <td class="px-4 py-3">PCAnywhere</td>
                                <td class="px-4 py-3">Remote Administration</td>
                                <td class="px-4 py-3 text-red-600">Authentication bypass, outdated versions, weak encryption</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5666</td>
                                <td class="px-4 py-3">Nagios NRPE</td>
                                <td class="px-4 py-3">Monitoring Agent</td>
                                <td class="px-4 py-3 text-red-600">Command injection, remote code execution, weak configuration</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5672</td>
                                <td class="px-4 py-3">AMQP</td>
                                <td class="px-4 py-3">Advanced Message Queuing Protocol</td>
                                <td class="px-4 py-3 text-red-600">Default credentials, message interception, DoS attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5900</td>
                                <td class="px-4 py-3">VNC</td>
                                <td class="px-4 py-3">Virtual Network Computing</td>
                                <td class="px-4 py-3 text-red-600">Weak passwords, no encryption by default, brute force attacks</td>
                            </tr>
                            <tr>
                                <td class="px-4 py-3 font-medium">5984</td>
                                <td class="px-4 py-3">CouchDB</td>
                                <td class="px-4 py-3">Document Database</td>
                                <td class="px-4 py-3 text-red-600

        <!-- Footer -->
        <footer class="mt-8 text-center text-sm text-gray-500">
            <p>This tool is for educational purposes only. Always scan networks with proper authorization.</p>
        </footer>
    </div>
    <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // DOM Elements
    const scanForm = document.getElementById('scanForm');
    const ipInput = document.getElementById('ip_range');
    const scanStatus = document.getElementById('scanStatus');
    const loader = document.getElementById('loader');
    const resultsContainer = document.getElementById('resultsContainer');

    // Event Listeners
    scanForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const target = ipInput.value.trim();
        
        if (!target) {
            showAlert('Please enter an IP address or range');
            return;
        }

        // Clear previous results
        resultsContainer.innerHTML = '';
        loader.classList.remove('hidden');
        scanStatus.textContent = 'Scanning...';

        try {
            let scanTarget = target;
            
            // Handle 'myip' shortcut
            if (target.toLowerCase() === 'myip') {
                const ipResponse = await fetch('/get_my_ip');
                const { ip } = await ipResponse.json();
                scanTarget = ip;
                ipInput.value = ip;
            }

            const response = await fetch('/scan', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ target: scanTarget })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error || 'Scan failed');
            }

            const { results } = await response.json();
            displayResults(results);
            scanStatus.textContent = `Scan complete: ${results.length} hosts found`;
        } catch (error) {
            scanStatus.textContent = `Error: ${error.message}`;
            console.error('Scan error:', error);
        } finally {
            loader.classList.add('hidden');
        }
    });

    function displayResults(results) {
        resultsContainer.innerHTML = '';
        
        if (!results || !results.length) {
            resultsContainer.innerHTML = `
                <div class="p-4 text-center text-gray-500">
                    <i data-lucide="search-x" class="w-12 h-12 mx-auto"></i>
                    <p class="mt-2">No scan results found</p>
                </div>
            `;
            return;
        }

        results.forEach(host => {
            const hostCard = document.createElement('div');
            hostCard.className = 'mb-4 border rounded-lg bg-white';
            
            // Host header
            const header = document.createElement('div');
            header.className = 'p-4 flex justify-between items-center cursor-pointer border-b';
            header.innerHTML = `
                <div class="flex items-center gap-3">
                    <i data-lucide="${host.vulnerabilities.length ? 'alert-triangle' : 'server'}" 
                       class="w-5 h-5 ${host.vulnerabilities.length ? 'text-red-500' : 'text-gray-500'}"></i>
                    <div>
                        <h3 class="font-medium">${host.ip}</h3>
                        <p class="text-sm text-gray-500">${host.source.toUpperCase()} scan</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <div class="badge ${host.ports.length ? 'badge-warning' : 'badge-success'}">
                        ${host.ports.length} ports
                    </div>
                    <div class="badge ${host.vulnerabilities.length ? 'badge-error' : 'badge-success'}">
                        ${host.vulnerabilities.length} vulns
                    </div>
                </div>
            `;

            // Host details
            const details = document.createElement('div');
            details.className = 'hidden p-4 space-y-4';
            
            if (host.ports.length) {
                details.innerHTML += `
                    <div class="space-y-2">
                        <h4 class="font-medium flex items-center gap-2">
                            <i data-lucide="plug" class="w-4 h-4"></i>
                            Open Ports
                        </h4>
                        ${host.ports.map(port => `
                            <div class="p-3 bg-blue-50 rounded-md">
                                <div class="flex justify-between items-center">
                                    <span>Port ${port.port}</span>
                                    <span class="badge badge-success">${port.service}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            if (host.vulnerabilities.length) {
                details.innerHTML += `
                    <div class="space-y-2">
                        <h4 class="font-medium flex items-center gap-2">
                            <i data-lucide="shield-alert" class="w-4 h-4"></i>
                            Vulnerabilities
                        </h4>
                        ${host.vulnerabilities.map(vuln => `
                            <div class="p-3 bg-red-50 rounded-md">
                                <div class="flex justify-between items-center">
                                    <span>${vuln}</span>
                                    <a href="https://nvd.nist.gov/vuln/detail/${vuln}" 
                                       target="_blank"
                                       class="badge badge-error hover:underline">
                                        Details
                                    </a>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            header.addEventListener('click', () => {
                details.classList.toggle('hidden');
                lucide.createIcons();
            });

            hostCard.append(header, details);
            resultsContainer.append(hostCard);
        });

        lucide.createIcons();
    }

    function showAlert(message, type = 'error') {
        const alert = document.createElement('div');
        alert.className = `fixed top-4 right-4 p-4 rounded-lg ${
            type === 'error' ? 'bg-red-100 text-red-800' : 'bg-blue-100 text-blue-800'
        }`;
        alert.innerHTML = `
            <div class="flex items-center gap-2">
                <i data-lucide="${type === 'error' ? 'alert-circle' : 'info'}"></i>
                <span>${message}</span>
            </div>
        `;
        
        document.body.append(alert);
        setTimeout(() => alert.remove(), 3000);
        lucide.createIcons();
    }
</script>
</body>
</html>
